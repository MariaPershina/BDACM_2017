---
title: "Bayesian data analysis & cognitive modeling"
subtitle: "02: data wrangling & visualization"
author: "Michael Franke"
output:
  ioslides_presentation:
    css: mistyle.css
    smaller: yes
    transition: faster
    widescreen: yes
---

```{r setup, include=FALSE, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE, dev.args = list(bg = 'transparent'), fig.align='center')
require('tidyverse')
theme_set(theme_bw() + theme(plot.background=element_blank()) )
```

## road map for today

<span style = "color:white"> &nbsp; </span>

- get in touch with R for <span style = "color:firebrick">data wrangling & plotting</span>
    
<span style = "color:white"> &nbsp; </span>

- look at data set from a <span style = "color:firebrick">case study</span> on quantifier <span style = "font-style: italic">some</span>

# R for data science

## data science

<div align = 'center'>
  <img src="pics/data_scientist_def.jpg" alt="data scientist" style="width: 700px;"/>
</div>

<div style = "position:absolute; top: 620px; right:60px;">
  read [more](https://priceonomics.com/whats-the-difference-between-data-science-and/)
</div>

# R

<span style = "color:white"> &nbsp; </span>

- special purpose programming language
    - statistics
    - data mining
    - data visualization

# case study

## truth-value judgement task 

<div align = 'center'>
  <img src="pics/typicality_exp_binary_screenshot.png" alt="binary" style="width: 400px;"/>
</div>

## test your intuitions

"Some of the circles are black."

<div align = 'left'>
  <img src="pics/bw_balls/0.png" alt="0balls" style="width: 180px;"/>
  <img src="pics/bw_balls/1.png" alt="1balls" style="width: 180px;"/>
  <img src="pics/bw_balls/2.png" alt="2balls" style="width: 180px;"/>
  <img src="pics/bw_balls/3.png" alt="3balls" style="width: 180px;"/>
  
  <img src="pics/bw_balls/4.png" alt="4balls" style="width: 180px;"/>
  <img src="pics/bw_balls/5.png" alt="1balls" style="width: 180px;"/>
  <img src="pics/bw_balls/6.png" alt="2balls" style="width: 180px;"/>
  <img src="pics/bw_balls/7.png" alt="3balls" style="width: 180px;"/>
  
  <img src="pics/bw_balls/8.png" alt="4balls" style="width: 180px;"/>
  <img src="pics/bw_balls/9.png" alt="4balls" style="width: 180px;"/>
  <img src="pics/bw_balls/10.png" alt="4balls" style="width: 180px;"/>
</div>

## rating scale task

<div align = 'center'>
  <img src="pics/typicality_exp_rating_screenshot.png" alt="ordinal" style="width: 600px;"/>
</div>

## design

- replication/extension of previous work
    - van Tiel & Geurts (2014), van Tiel (2014), Degen & Tanenhaus (2015)
- 4 experimental variants:
    - binary truth-value judgements vs. 7-point rating scale
    - include filler sentences with $\textit{many}$ and $\textit{most}$ or not
- participants recruited via Amazon's Mechanical Turk
    - each subject rated 3 sentences with <span style = "font-style: italic">some</span>
    - pseudo-randomized order; fully randomized visual displays


<span style = "color:white"> dummy </span>

<div align = 'center'>
  <img src="pics/typicality_exps_table.png" alt="expTable" style="width: 500px;"/>
</div>

# data wrangling

## read data

```{r, message = T}
d = readr::read_csv('../data/00_typicality_some.csv') # from package 'readr'
```

## inspect data

```{r}
d
```

## any comments?

```{r}
levels(factor(d$comments))[1:20]
```


## self-reported native languages

```{r}
table(d$language)
```

## filter non-native speakers of Enblush

```{r}
d = dplyr::filter(d, ! language %in% c("FRENCH", "Japanese", "Russian", "Spanish", "Tamil", "white"))
table(d$language)
```


## select relevant columns & rows

```{r}
d = d %>% dplyr::filter(type == "some") %>% 
          dplyr::select(-language, -comments, -type)
d
```

## more intelligible column names

```{r}
d = d %>% dplyr::rename(condition = nr_black)
d
```

## adding columns

```{r}
d = d %>% dplyr::mutate(dependent.measure = ifelse(variant %in% c("A", "B"), "ordinal", "binary"),
                        alternatives = factor(ifelse(variant %in% c("A", "C"), "present", "absent"))) %>% 
          dplyr::select(- variant)
d
```

## rescale responses

```{r}
d = d %>% mutate(response = purrr::map2_dbl(dependent.measure, response, 
                                            function(x,y) { ifelse(x == "ordinal", (y-1)/6, y) } ))
d
```


## get mean RTs for dependent measures

```{r}
d %>% dplyr::group_by(dependent.measure) %>% 
      dplyr::summarize(mean.response = mean(response)) %>% show()
```


## get mean responses

```{r}
resp.summary = d %>% dplyr::group_by(dependent.measure, alternatives, condition) %>% 
                     dplyr::summarize(mean.response = mean(response))
resp.summary
```

# data visualization

## a naked plot

```{r}
ggplot()
```

## plotting mean responses

```{r}
ggplot(data = resp.summary, aes(x = condition, y = mean.response)) +
  geom_point()
```

## plotting mean responses per treatment

```{r}
ggplot(data = resp.summary, aes(x = condition, y = mean.response, color = alternatives)) +
  geom_point()
```

## plotting mean responses per treatment & depentend measure

```{r}
ggplot(data = resp.summary, aes(x = condition, y = mean.response, color = alternatives)) +
  geom_point() + geom_line() + facet_grid( . ~ dependent.measure)
```

## some cosmetics

```{r}
ggplot(data = resp.summary, aes(x = condition, y = mean.response, color = alternatives)) +
  geom_point() + geom_line() + facet_grid( . ~ dependent.measure) + 
  xlab("number of black balls") + ylab("mean response") +
  scale_x_continuous(breaks = 0:10) + scale_color_manual(values = c("darkgrey", "firebrick"))
```

# towards Bayesian modeling

## methodological puzzles

- do binary and ordinal tasks measure the same thing?
    - one is about truth, the other about "goodness"
    - <span style = "color:firebrick">what does it even mean to measure something with a task?</span>
- is what either task measures influenced by presence/absence of alternatives?
    - <span style = "color:firebrick">what is the effect of additional fillers on judgements?</span>
- how would we answer these questions with standard statistical techniques?
    - <span style = "color:firebrick">is there a place for pragmatic theory in a statistical model?</span>

## custom-made data-generating model

<div style = "position:absolute; top: 100px; left:100px;">
  <img src="pics/typicality_modelGraph.png" alt="modelGraph" style="width: 625px;"/>
</div>

## results: PPCs for trained model

<div align = 'center'>
  <img src="pics/typicality_PPCs.jpg" alt="PPCs" style="width: 750px;"/>
</div>

# fini

## preparation for next class

<span style = "color:white"> &nbsp; </span>

- read more on [R for Data Science](http://r4ds.had.co.nz)

<span style = "color:white"> &nbsp; </span>

- read Kruschke Chapter 4